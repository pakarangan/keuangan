{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":29,"index":44},"end":{"line":3,"column":84,"index":99}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/objectSpread2","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":44,"index":206},"end":{"line":6,"column":91,"index":253}}],"key":"F+ExrfS9dcoZxXJOBwTmx09hji8=","exportNames":["*"],"imports":1}},{"name":"fbjs/lib/invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":40,"index":296},"end":{"line":7,"column":69,"index":325}}],"key":"ePiUN85REKH0vTLGPPDgdWgjFww=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _classCallCheck = require(_dependencyMap[0], \"@babel/runtime/helpers/classCallCheck\").default;\n  var _createClass = require(_dependencyMap[1], \"@babel/runtime/helpers/createClass\").default;\n  var _interopRequireDefault = require(_dependencyMap[2], \"@babel/runtime/helpers/interopRequireDefault\").default;\n  exports.__esModule = true;\n  exports.default = void 0;\n  var _objectSpread2 = _interopRequireDefault(require(_dependencyMap[3], \"@babel/runtime/helpers/objectSpread2\"));\n  var _invariant = _interopRequireDefault(require(_dependencyMap[4], \"fbjs/lib/invariant\"));\n  /**\n   * Copyright (c) Nicolas Gallagher.\n   * Copyright (c) Meta Platforms, Inc. and affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *\n   * \n   */\n  var TaskQueue = /*#__PURE__*/function () {\n    function TaskQueue(_ref) {\n      _classCallCheck(this, TaskQueue);\n      var onMoreTasks = _ref.onMoreTasks;\n      this._onMoreTasks = onMoreTasks;\n      this._queueStack = [{\n        tasks: [],\n        popable: true\n      }];\n    }\n    return _createClass(TaskQueue, [{\n      key: \"enqueue\",\n      value: function enqueue(task) {\n        this._getCurrentQueue().push(task);\n      }\n    }, {\n      key: \"enqueueTasks\",\n      value: function enqueueTasks(tasks) {\n        var _this = this;\n        tasks.forEach(function (task) {\n          return _this.enqueue(task);\n        });\n      }\n    }, {\n      key: \"cancelTasks\",\n      value: function cancelTasks(tasksToCancel) {\n        this._queueStack = this._queueStack.map(function (queue) {\n          return (0, _objectSpread2.default)((0, _objectSpread2.default)({}, queue), {}, {\n            tasks: queue.tasks.filter(function (task) {\n              return tasksToCancel.indexOf(task) === -1;\n            })\n          });\n        }).filter(function (queue, idx) {\n          return queue.tasks.length > 0 || idx === 0;\n        });\n      }\n    }, {\n      key: \"hasTasksToProcess\",\n      value: function hasTasksToProcess() {\n        return this._getCurrentQueue().length > 0;\n      }\n\n      /**\n       * Executes the next task in the queue.\n       */\n    }, {\n      key: \"processNext\",\n      value: function processNext() {\n        var queue = this._getCurrentQueue();\n        if (queue.length) {\n          var task = queue.shift();\n          try {\n            if (typeof task === 'object' && task.gen) {\n              this._genPromise(task);\n            } else if (typeof task === 'object' && task.run) {\n              task.run();\n            } else {\n              (0, _invariant.default)(typeof task === 'function', 'Expected Function, SimpleTask, or PromiseTask, but got:\\n' + JSON.stringify(task, null, 2));\n              task();\n            }\n          } catch (e) {\n            e.message = 'TaskQueue: Error with task ' + (task.name || '') + ': ' + e.message;\n            throw e;\n          }\n        }\n      }\n    }, {\n      key: \"_getCurrentQueue\",\n      value: function _getCurrentQueue() {\n        var stackIdx = this._queueStack.length - 1;\n        var queue = this._queueStack[stackIdx];\n        if (queue.popable && queue.tasks.length === 0 && stackIdx > 0) {\n          this._queueStack.pop();\n          return this._getCurrentQueue();\n        } else {\n          return queue.tasks;\n        }\n      }\n    }, {\n      key: \"_genPromise\",\n      value: function _genPromise(task) {\n        var _this2 = this;\n        var length = this._queueStack.push({\n          tasks: [],\n          popable: false\n        });\n        var stackIdx = length - 1;\n        var stackItem = this._queueStack[stackIdx];\n        task.gen().then(function () {\n          stackItem.popable = true;\n          _this2.hasTasksToProcess() && _this2._onMoreTasks();\n        }).catch(function (ex) {\n          setTimeout(function () {\n            ex.message = \"TaskQueue: Error resolving Promise in task \" + task.name + \": \" + ex.message;\n            throw ex;\n          }, 0);\n        });\n      }\n    }]);\n  }();\n  var _default = exports.default = TaskQueue;\n  module.exports = exports.default;\n});","lineCount":122,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13],[4,6,1,13,"_classCallCheck"],[4,21,1,13],[4,24,1,13,"require"],[4,31,1,13],[4,32,1,13,"_dependencyMap"],[4,46,1,13],[4,92,1,13,"default"],[4,99,1,13],[5,2,1,13],[5,6,1,13,"_createClass"],[5,18,1,13],[5,21,1,13,"require"],[5,28,1,13],[5,29,1,13,"_dependencyMap"],[5,43,1,13],[5,86,1,13,"default"],[5,93,1,13],[6,2,3,0],[6,6,3,4,"_interopRequireDefault"],[6,28,3,26],[6,31,3,29,"require"],[6,38,3,36],[6,39,3,36,"_dependencyMap"],[6,53,3,36],[6,104,3,83],[6,105,3,84],[6,106,3,85,"default"],[6,113,3,92],[7,2,4,0,"exports"],[7,9,4,7],[7,10,4,8,"__esModule"],[7,20,4,18],[7,23,4,21],[7,27,4,25],[8,2,5,0,"exports"],[8,9,5,7],[8,10,5,8,"default"],[8,17,5,15],[8,20,5,18],[8,25,5,23],[8,26,5,24],[9,2,6,0],[9,6,6,4,"_objectSpread2"],[9,20,6,18],[9,23,6,21,"_interopRequireDefault"],[9,45,6,43],[9,46,6,44,"require"],[9,53,6,51],[9,54,6,51,"_dependencyMap"],[9,68,6,51],[9,111,6,90],[9,112,6,91],[9,113,6,92],[10,2,7,0],[10,6,7,4,"_invariant"],[10,16,7,14],[10,19,7,17,"_interopRequireDefault"],[10,41,7,39],[10,42,7,40,"require"],[10,49,7,47],[10,50,7,47,"_dependencyMap"],[10,64,7,47],[10,89,7,68],[10,90,7,69],[10,91,7,70],[11,2,8,0],[12,0,9,0],[13,0,10,0],[14,0,11,0],[15,0,12,0],[16,0,13,0],[17,0,14,0],[18,0,15,0],[19,0,16,0],[20,2,8,0],[20,6,18,6,"TaskQueue"],[20,15,18,15],[21,4,19,2],[21,13,19,2,"TaskQueue"],[21,23,19,14,"_ref"],[21,27,19,18],[21,29,19,20],[22,6,19,20,"_classCallCheck"],[22,21,19,20],[22,28,19,20,"TaskQueue"],[22,37,19,20],[23,6,20,4],[23,10,20,8,"onMoreTasks"],[23,21,20,19],[23,24,20,22,"_ref"],[23,28,20,26],[23,29,20,27,"onMoreTasks"],[23,40,20,38],[24,6,21,4],[24,10,21,8],[24,11,21,9,"_onMoreTasks"],[24,23,21,21],[24,26,21,24,"onMoreTasks"],[24,37,21,35],[25,6,22,4],[25,10,22,8],[25,11,22,9,"_queueStack"],[25,22,22,20],[25,25,22,23],[25,26,22,24],[26,8,23,6,"tasks"],[26,13,23,11],[26,15,23,13],[26,17,23,15],[27,8,24,6,"popable"],[27,15,24,13],[27,17,24,15],[28,6,25,4],[28,7,25,5],[28,8,25,6],[29,4,26,2],[30,4,26,3],[30,11,26,3,"_createClass"],[30,23,26,3],[30,24,26,3,"TaskQueue"],[30,33,26,3],[31,6,26,3,"key"],[31,9,26,3],[32,6,26,3,"value"],[32,11,26,3],[32,13,27,2],[32,22,27,2,"enqueue"],[32,29,27,9,"enqueue"],[32,30,27,10,"task"],[32,34,27,14],[32,36,27,16],[33,8,28,4],[33,12,28,8],[33,13,28,9,"_getCurrentQueue"],[33,29,28,25],[33,30,28,26],[33,31,28,27],[33,32,28,28,"push"],[33,36,28,32],[33,37,28,33,"task"],[33,41,28,37],[33,42,28,38],[34,6,29,2],[35,4,29,3],[36,6,29,3,"key"],[36,9,29,3],[37,6,29,3,"value"],[37,11,29,3],[37,13,30,2],[37,22,30,2,"enqueueTasks"],[37,34,30,14,"enqueueTasks"],[37,35,30,15,"tasks"],[37,40,30,20],[37,42,30,22],[38,8,30,22],[38,12,30,22,"_this"],[38,17,30,22],[39,8,31,4,"tasks"],[39,13,31,9],[39,14,31,10,"forEach"],[39,21,31,17],[39,22,31,18],[39,32,31,18,"task"],[39,36,31,22],[40,10,31,22],[40,17,31,26,"_this"],[40,22,31,30],[40,23,31,31,"enqueue"],[40,30,31,38],[40,31,31,39,"task"],[40,35,31,43],[40,36,31,44],[41,8,31,44],[41,10,31,45],[42,6,32,2],[43,4,32,3],[44,6,32,3,"key"],[44,9,32,3],[45,6,32,3,"value"],[45,11,32,3],[45,13,33,2],[45,22,33,2,"cancelTasks"],[45,33,33,13,"cancelTasks"],[45,34,33,14,"tasksToCancel"],[45,47,33,27],[45,49,33,29],[46,8,34,4],[46,12,34,8],[46,13,34,9,"_queueStack"],[46,24,34,20],[46,27,34,23],[46,31,34,27],[46,32,34,28,"_queueStack"],[46,43,34,39],[46,44,34,40,"map"],[46,47,34,43],[46,48,34,44],[46,58,34,44,"queue"],[46,63,34,49],[47,10,34,49],[47,17,34,53],[47,18,34,54],[47,19,34,55],[47,21,34,57,"_objectSpread2"],[47,35,34,71],[47,36,34,72,"default"],[47,43,34,79],[47,45,34,81],[47,46,34,82],[47,47,34,83],[47,49,34,85,"_objectSpread2"],[47,63,34,99],[47,64,34,100,"default"],[47,71,34,107],[47,73,34,109],[47,74,34,110],[47,75,34,111],[47,77,34,113,"queue"],[47,82,34,118],[47,83,34,119],[47,85,34,121],[47,86,34,122],[47,87,34,123],[47,89,34,125],[48,12,35,6,"tasks"],[48,17,35,11],[48,19,35,13,"queue"],[48,24,35,18],[48,25,35,19,"tasks"],[48,30,35,24],[48,31,35,25,"filter"],[48,37,35,31],[48,38,35,32],[48,48,35,32,"task"],[48,52,35,36],[49,14,35,36],[49,21,35,40,"tasksToCancel"],[49,34,35,53],[49,35,35,54,"indexOf"],[49,42,35,61],[49,43,35,62,"task"],[49,47,35,66],[49,48,35,67],[49,53,35,72],[49,54,35,73],[49,55,35,74],[50,12,35,74],[51,10,36,4],[51,11,36,5],[51,12,36,6],[52,8,36,6],[52,10,36,7],[52,11,36,8,"filter"],[52,17,36,14],[52,18,36,15],[52,28,36,16,"queue"],[52,33,36,21],[52,35,36,23,"idx"],[52,38,36,26],[53,10,36,26],[53,17,36,31,"queue"],[53,22,36,36],[53,23,36,37,"tasks"],[53,28,36,42],[53,29,36,43,"length"],[53,35,36,49],[53,38,36,52],[53,39,36,53],[53,43,36,57,"idx"],[53,46,36,60],[53,51,36,65],[53,52,36,66],[54,8,36,66],[54,10,36,67],[55,6,37,2],[56,4,37,3],[57,6,37,3,"key"],[57,9,37,3],[58,6,37,3,"value"],[58,11,37,3],[58,13,38,2],[58,22,38,2,"hasTasksToProcess"],[58,39,38,19,"hasTasksToProcess"],[58,40,38,19],[58,42,38,22],[59,8,39,4],[59,15,39,11],[59,19,39,15],[59,20,39,16,"_getCurrentQueue"],[59,36,39,32],[59,37,39,33],[59,38,39,34],[59,39,39,35,"length"],[59,45,39,41],[59,48,39,44],[59,49,39,45],[60,6,40,2],[62,6,42,2],[63,0,43,0],[64,0,44,0],[65,4,42,2],[66,6,42,2,"key"],[66,9,42,2],[67,6,42,2,"value"],[67,11,42,2],[67,13,45,2],[67,22,45,2,"processNext"],[67,33,45,13,"processNext"],[67,34,45,13],[67,36,45,16],[68,8,46,4],[68,12,46,8,"queue"],[68,17,46,13],[68,20,46,16],[68,24,46,20],[68,25,46,21,"_getCurrentQueue"],[68,41,46,37],[68,42,46,38],[68,43,46,39],[69,8,47,4],[69,12,47,8,"queue"],[69,17,47,13],[69,18,47,14,"length"],[69,24,47,20],[69,26,47,22],[70,10,48,6],[70,14,48,10,"task"],[70,18,48,14],[70,21,48,17,"queue"],[70,26,48,22],[70,27,48,23,"shift"],[70,32,48,28],[70,33,48,29],[70,34,48,30],[71,10,49,6],[71,14,49,10],[72,12,50,8],[72,16,50,12],[72,23,50,19,"task"],[72,27,50,23],[72,32,50,28],[72,40,50,36],[72,44,50,40,"task"],[72,48,50,44],[72,49,50,45,"gen"],[72,52,50,48],[72,54,50,50],[73,14,51,10],[73,18,51,14],[73,19,51,15,"_genPromise"],[73,30,51,26],[73,31,51,27,"task"],[73,35,51,31],[73,36,51,32],[74,12,52,8],[74,13,52,9],[74,19,52,15],[74,23,52,19],[74,30,52,26,"task"],[74,34,52,30],[74,39,52,35],[74,47,52,43],[74,51,52,47,"task"],[74,55,52,51],[74,56,52,52,"run"],[74,59,52,55],[74,61,52,57],[75,14,53,10,"task"],[75,18,53,14],[75,19,53,15,"run"],[75,22,53,18],[75,23,53,19],[75,24,53,20],[76,12,54,8],[76,13,54,9],[76,19,54,15],[77,14,55,10],[77,15,55,11],[77,16,55,12],[77,18,55,14,"_invariant"],[77,28,55,24],[77,29,55,25,"default"],[77,36,55,32],[77,38,55,34],[77,45,55,41,"task"],[77,49,55,45],[77,54,55,50],[77,64,55,60],[77,66,55,62],[77,125,55,121],[77,128,55,124,"JSON"],[77,132,55,128],[77,133,55,129,"stringify"],[77,142,55,138],[77,143,55,139,"task"],[77,147,55,143],[77,149,55,145],[77,153,55,149],[77,155,55,151],[77,156,55,152],[77,157,55,153],[77,158,55,154],[78,14,56,10,"task"],[78,18,56,14],[78,19,56,15],[78,20,56,16],[79,12,57,8],[80,10,58,6],[80,11,58,7],[80,12,58,8],[80,19,58,15,"e"],[80,20,58,16],[80,22,58,18],[81,12,59,8,"e"],[81,13,59,9],[81,14,59,10,"message"],[81,21,59,17],[81,24,59,20],[81,53,59,49],[81,57,59,53,"task"],[81,61,59,57],[81,62,59,58,"name"],[81,66,59,62],[81,70,59,66],[81,72,59,68],[81,73,59,69],[81,76,59,72],[81,80,59,76],[81,83,59,79,"e"],[81,84,59,80],[81,85,59,81,"message"],[81,92,59,88],[82,12,60,8],[82,18,60,14,"e"],[82,19,60,15],[83,10,61,6],[84,8,62,4],[85,6,63,2],[86,4,63,3],[87,6,63,3,"key"],[87,9,63,3],[88,6,63,3,"value"],[88,11,63,3],[88,13,64,2],[88,22,64,2,"_getCurrentQueue"],[88,38,64,18,"_getCurrentQueue"],[88,39,64,18],[88,41,64,21],[89,8,65,4],[89,12,65,8,"stackIdx"],[89,20,65,16],[89,23,65,19],[89,27,65,23],[89,28,65,24,"_queueStack"],[89,39,65,35],[89,40,65,36,"length"],[89,46,65,42],[89,49,65,45],[89,50,65,46],[90,8,66,4],[90,12,66,8,"queue"],[90,17,66,13],[90,20,66,16],[90,24,66,20],[90,25,66,21,"_queueStack"],[90,36,66,32],[90,37,66,33,"stackIdx"],[90,45,66,41],[90,46,66,42],[91,8,67,4],[91,12,67,8,"queue"],[91,17,67,13],[91,18,67,14,"popable"],[91,25,67,21],[91,29,67,25,"queue"],[91,34,67,30],[91,35,67,31,"tasks"],[91,40,67,36],[91,41,67,37,"length"],[91,47,67,43],[91,52,67,48],[91,53,67,49],[91,57,67,53,"stackIdx"],[91,65,67,61],[91,68,67,64],[91,69,67,65],[91,71,67,67],[92,10,68,6],[92,14,68,10],[92,15,68,11,"_queueStack"],[92,26,68,22],[92,27,68,23,"pop"],[92,30,68,26],[92,31,68,27],[92,32,68,28],[93,10,69,6],[93,17,69,13],[93,21,69,17],[93,22,69,18,"_getCurrentQueue"],[93,38,69,34],[93,39,69,35],[93,40,69,36],[94,8,70,4],[94,9,70,5],[94,15,70,11],[95,10,71,6],[95,17,71,13,"queue"],[95,22,71,18],[95,23,71,19,"tasks"],[95,28,71,24],[96,8,72,4],[97,6,73,2],[98,4,73,3],[99,6,73,3,"key"],[99,9,73,3],[100,6,73,3,"value"],[100,11,73,3],[100,13,74,2],[100,22,74,2,"_genPromise"],[100,33,74,13,"_genPromise"],[100,34,74,14,"task"],[100,38,74,18],[100,40,74,20],[101,8,74,20],[101,12,74,20,"_this2"],[101,18,74,20],[102,8,75,4],[102,12,75,8,"length"],[102,18,75,14],[102,21,75,17],[102,25,75,21],[102,26,75,22,"_queueStack"],[102,37,75,33],[102,38,75,34,"push"],[102,42,75,38],[102,43,75,39],[103,10,76,6,"tasks"],[103,15,76,11],[103,17,76,13],[103,19,76,15],[104,10,77,6,"popable"],[104,17,77,13],[104,19,77,15],[105,8,78,4],[105,9,78,5],[105,10,78,6],[106,8,79,4],[106,12,79,8,"stackIdx"],[106,20,79,16],[106,23,79,19,"length"],[106,29,79,25],[106,32,79,28],[106,33,79,29],[107,8,80,4],[107,12,80,8,"stackItem"],[107,21,80,17],[107,24,80,20],[107,28,80,24],[107,29,80,25,"_queueStack"],[107,40,80,36],[107,41,80,37,"stackIdx"],[107,49,80,45],[107,50,80,46],[108,8,81,4,"task"],[108,12,81,8],[108,13,81,9,"gen"],[108,16,81,12],[108,17,81,13],[108,18,81,14],[108,19,81,15,"then"],[108,23,81,19],[108,24,81,20],[108,36,81,26],[109,10,82,6,"stackItem"],[109,19,82,15],[109,20,82,16,"popable"],[109,27,82,23],[109,30,82,26],[109,34,82,30],[110,10,83,6,"_this2"],[110,16,83,10],[110,17,83,11,"hasTasksToProcess"],[110,34,83,28],[110,35,83,29],[110,36,83,30],[110,40,83,34,"_this2"],[110,46,83,38],[110,47,83,39,"_onMoreTasks"],[110,59,83,51],[110,60,83,52],[110,61,83,53],[111,8,84,4],[111,9,84,5],[111,10,84,6],[111,11,84,7,"catch"],[111,16,84,12],[111,17,84,13],[111,27,84,13,"ex"],[111,29,84,15],[111,31,84,19],[112,10,85,6,"setTimeout"],[112,20,85,16],[112,21,85,17],[112,33,85,23],[113,12,86,8,"ex"],[113,14,86,10],[113,15,86,11,"message"],[113,22,86,18],[113,25,86,21],[113,70,86,66],[113,73,86,69,"task"],[113,77,86,73],[113,78,86,74,"name"],[113,82,86,78],[113,85,86,81],[113,89,86,85],[113,92,86,88,"ex"],[113,94,86,90],[113,95,86,91,"message"],[113,102,86,98],[114,12,87,8],[114,18,87,14,"ex"],[114,20,87,16],[115,10,88,6],[115,11,88,7],[115,13,88,9],[115,14,88,10],[115,15,88,11],[116,8,89,4],[116,9,89,5],[116,10,89,6],[117,6,90,2],[118,4,90,3],[119,2,90,3],[120,2,92,0],[120,6,92,4,"_default"],[120,14,92,12],[120,17,92,15,"exports"],[120,24,92,22],[120,25,92,23,"default"],[120,32,92,30],[120,35,92,33,"TaskQueue"],[120,44,92,42],[121,2,93,0,"module"],[121,8,93,6],[121,9,93,7,"exports"],[121,16,93,14],[121,19,93,17,"exports"],[121,26,93,24],[121,27,93,25,"default"],[121,34,93,32],[122,0,93,33],[122,3]],"functionMap":{"names":["<global>","TaskQueue","constructor","enqueue","enqueueTasks","tasks.forEach$argument_0","cancelTasks","_queueStack.map$argument_0","queue.tasks.filter$argument_0","_queueStack.map.filter$argument_0","hasTasksToProcess","processNext","_getCurrentQueue","_genPromise","task.gen.then$argument_0","task.gen.then._catch$argument_0","setTimeout$argument_0"],"mappings":"AAA;ACiB;ECC;GDO;EEC;GFE;EGC;kBCC,0BD;GHC;EKC;4CCC;gCCC,0CD;MDC,SG,mDH;GLC;ESC;GTE;EUK;GVkB;EWC;GXS;EYC;oBCO;KDG,QE;iBCC;ODG;KFC;GZC;CDC"},"hasCjsExports":true},"type":"js/module"}]}